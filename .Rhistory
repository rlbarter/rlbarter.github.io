a <- 1
install.packages("tibble")
knitr::opts_chunk$set(echo = TRUE)
library(superheat)
WSS <- data %>%
group_by(variable) %>%
mutate(value.mean = mean(value)) %>%
mutate(SS = (value - value.mean)^2) %>%
ungroup() %>%
summarise(WSS = sum(SS)) %>%
select(WSS) %>%
unlist()
library(dplyr)
library(reshape2)
library(ggplot2)
set.seed(2346827)
data <- data.frame(A = rnorm(20, 1, 0.5),
B = rnorm(20, 2, 0.5),
C = rnorm(20, 1.5, 0.5))
data <- melt(data)
data <- data %>%
group_by(variable) %>%
mutate(mean = mean(value),
numeric.variable = as.numeric(variable) + rnorm(20, 0, 0.05))
summary(aov(value ~ variable, data = data))
WSS <- data %>%
group_by(variable) %>%
mutate(value.mean = mean(value)) %>%
mutate(SS = (value - value.mean)^2) %>%
ungroup() %>%
summarise(WSS = sum(SS)) %>%
select(WSS) %>%
unlist()
WSS
BSS <- data %>%
mutate(value.global.mean = mean(value)) %>%
group_by(variable) %>%
summarise(value.var.mean = mean(value),
n = n(),
value.global.mean = unique(value.global.mean)) %>%
mutate(SS = n * (value.var.mean - value.global.mean)^2) %>%
ungroup() %>%
summarise(BSS = sum(SS)) %>%
unlist()
BSS
BSS <- data %>%
mutate(value.global.mean = mean(value))
data %>%
mutate(value.global.mean = mean(value))
data %>%
mutate(value.global.mean = mean(value)) %>%
group_by(variable) %>%
summarise(value.var.mean = mean(value),
n = n(),
value.global.mean = unique(value.global.mean))
data %>%
mutate(value.global.mean = mean(value))
BSS <- data %>%
ungroup() %>%
mutate(value.global.mean = mean(value)) %>%
group_by(variable) %>%
summarise(value.var.mean = mean(value),
n = n(),
value.global.mean = unique(value.global.mean)) %>%
mutate(SS = n * (value.var.mean - value.global.mean)^2) %>%
ungroup() %>%
summarise(BSS = sum(SS)) %>%
unlist()
BSS
nrow(data) - 3
F <- (BSS/2) / (WSS/(nrow(data) - 3))
names(F) <- NULL
F
WSS
(BSS/2)
(WSS/(nrow(data) - 3))
# Chunk 1
library(data.table)
library(httr)
# set the url: location of data
url <- "https://archive.ics.uci.edu/ml/machine-learning-databases/00296/dataset_diabetes.zip"
# download the zipped data file
response <- GET(url, write_disk("diabetes.csv.zip",
overwrite = TRUE),
progress())
# unzip the data file
file <- unzip("diabetes.csv.zip")
# load the unzipped data file into R
diabetes.orig <- read.csv(file[1], stringsAsFactors = FALSE)
# Chunk 2
# data dimension
dim(diabetes.orig)
# look at the first 6 rows of the dataset
head(diabetes.orig)
# Chunk 3
# make a copy of the original object
diabetes.clean <- diabetes.orig
# Chunk 4
# replace all incidences of "?" with NA
diabetes.clean[diabetes.clean == "?"] <- NA
# Chunk 5
# convert the age range to a midpoint
# this is a bit of a messy hack but it does the job!
diabetes.clean$age <- unlist(lapply(strsplit(
gsub("\\)", "",
gsub("\\[", "",
diabetes.clean$age)), "-"),
function(x) mean(as.numeric(x))))
# Chunk 6
numeric.vars <- sapply(diabetes.clean, function(x) inherits(x, "integer") | inherits(x, "numeric"))
cor(diabetes.clean[, numeric.vars])
library(superheat)
superheat(cor(diabetes.clean[, numeric.vars]))
superheat(cor(dlplyr::select(diabetes.clean, -patient_nbr, -encounter_id)[, numeric.vars]))
superheat(cor(dplyr::select(diabetes.clean, -patient_nbr, -encounter_id)[, numeric.vars]))
?ggplot
library(ggplot2)
?ggplot
df <- data.frame(
gp = factor(rep(letters[1:3], each = 10)),
y = rnorm(30)
)
ds <- plyr::ddply(df, "gp", plyr::summarise, mean = mean(y), sd = sd(y))
# The summary data frame ds is used to plot larger red points on top
# of the raw data. Note that we don't need to supply `data` or `mapping`
# in each layer because the defaults from ggplot() are used.
ggplot(df, aes(gp, y)) +
geom_point() +
geom_point(data = ds, aes(y = mean), colour = 'red', size = 3)
?geom_point
?hist
?superheat
library
library(superheat)
?superheat
setwd("~/Google Drive/Personal webpage/rlbarter.github.io/content/blog")
setwd("~/Google Drive/Personal webpage/rlbarter.github.io")
blogdown::serve_site()
